"use strict";r.Ae(200,function(){function t(t){if(p||t.v||(t.v=K.a(t.u)),null==t.textSplit){t.title=n(t.title);var e=t.t,r=i(e);t.t=e.length!==t.u.length?r:"",t.textSplit=s(r,u(r),e.length-r.length,p?U-13-Math.min(t.title.length,40):U)}else t.t===t.u&&(t.t="")}function n(t,n){var i=t.length>U+40;return i&&(t=r.S(t,0,U+39)),e(i?t+"\u2026":t,n||u(t))}function e(t,n){var e,i,u,o,l;if(0===n.length)return r.R(t);for(e="",i=0,u=0;u<n.length;u+=2)l=n[u+1],(o=n[u])>=t.length||(e+=r.R(t.slice(i,o)),e+="<match>",e+=r.R(t.slice(o,l)),e+="</match>",i=l);return e+r.R(t.slice(i))}function i(t){var n=r.Te(t);return!n||n>=t.length?t:t.slice(n,t.length-+(t.endsWith("/")&&!t.endsWith("://")))}function u(t){var n,e,r,i,u,l,s,f,a,c,_,g=[];for(n=0,e=k.length;n<e;n++)for(r=0,i=0,u=void 0,s=(l=t.split(G.Tr[n])).length-1,f=k[n].length;r<s;r++,i=u)u=(i+=l[r].length)+f,g.push([i,u]);if(0===g.length)return g;if(1===g.length)return g[0];for(g.sort(o),a=g[0],n=1,c=1,e=g.length;c<e;c++)a[n]>=(_=g[c])[0]?a[n]<_[1]&&(a[n]=_[1]):(a.push(_[0],_[1]),n+=2);return a}function o(t,n){return t[0]-n[0]}function s(t,n,e,i){var u,o,l,s,f,a="",c=t.length,_=c,g="";if(c<=i||(e>1?_=t.indexOf("/")+1||c:(_=t.indexOf(":"))<0?_=c:r.D.test(t.slice(0,_+3).toLowerCase())?_=t.indexOf("/",_+4)+1||c:_+=22),_<c&&n.length)for(u=n.length,o=c+8;(u-=2)>-4&&o>=_;o=u<0?0:n[u])if(l=u<0?_:n[u+1],(s=o-20-Math.max(l,_))>0&&(c-=s)<=i){_=l+(i-c);break}for(c=0,u=0;c<i&&u<n.length;u+=2)(s=(o=n[u])-20-(f=Math.max(c,_)))>0?(i+=s,g=r.S(t,c,f+11),a+=r.R(g),a+="\u2026",g=r.z(t,o-8,o),a+=r.R(g)):c<o&&(g=t.slice(c,o),a+=r.R(g)),g=t.slice(o,c=n[u+1]),a+="<match>",a+=r.R(g),a+="</match>";return t.length<=i?(g=t.slice(c),a+r.R(g)):(g=r.S(t,c,i-1>c?i-1:c+10),a+r.R(g)+"\u2026")}function a(t){return z.Mr(t.t,t.title)}function c(t){var n=(t-z.xr)/18144e5;return n<0?0:n<1?n*n*.666667:n<1.000165?.666446:0}function _(t,n,e){var r=c(e),i=z.Mr(t,n);return r<=i?i:(i+r)/2}function g(t,n){return n}var v=0,S=null,h=false,p=false,B=0,U=0,y=0,b=0,T=0,w=0,k=[""],M="",x="",R="",C="",O=0,D=false,N=false,I="",E="",j=0,F=null,J=true,P=function(t,n,e,r,i,u){this.e=t,this.u=n,this.t=e,this.title=r,this.r=i(this,u),this.visit=0},A=performance,L={Rr:[],Or:[],Dr:null,Nr:"",Er:0,jr:0,Zt:function(t,n){if(0!==k.length&&1&j)2===L.jr?L.Fr():L.Dr=t;else if(W.Jr([],1),n)return;0===L.jr&&L.Pr()},Ar:function(t){return 47===t.charCodeAt(0)},Fr:function(){var t,e,r,i,u,l,s,f,a,c,_,m=k.some(L.Ar),v=!!Y.Lr,d=[],S=Y.Vr&&Y.Vr.Rr||L.Rr,h=S.length,p=[];for(e=0;e<h;e++)if(z.$r((r=S[e]).t,m?r.Nr:r.qr)&&(J||r.Kr)){if(v&&d.push(r),E&&r.u.length<E.length+2&&E===(r.u.endsWith("/")?r.u.slice(0,-1):r.u))continue;p.push([-z.Mr(r.t,r.qr),e])}for(v&&(Y.Lr.Rr=d),T+=t=p.length,t?(p.sort(o),w>0&&!(6&j)?(p=p.slice(w,w+y),w=0):t>w+y&&(p.length=w+y)):j^=1,i=[],u=64&B?-.666446:0,l=0,s=p;l<s.length;l++)a=(f=s[l])[0],u&&(a=a<u?a:(a+u)/2),c=new P("bookm",(r=S[e=f[1]]).u,r.t,m?r.Nr:r.qr,g,-a),_=32&B&&X.Wr?X.Qr(r.u):-1,c.visit=_<0?0:X.Hr[_].zr,i.push(c),null!==r.Gr&&(c.u=r.Gr,c.title=n(m?r.Nr:r.qr),c.textSplit="javascript: \u2026",c.t=r.Xr);W.Jr(i,1)},Zr:function(){var t=chrome.bookmarks;t.onCreated.addListener(L.Yr),t.onRemoved.addListener(L.ti),t.onChanged.addListener(L.ti),t.onMoved.addListener(L.Yr),t.onImportBegan.addListener(function(){chrome.bookmarks.onCreated.removeListener(L.Yr)}),t.onImportEnded.addListener(function(){var t=L.Yr;chrome.bookmarks.onCreated.addListener(t),t()})},Pr:function(){L.jr=1,L.Sr&&(clearTimeout(L.Sr),L.Sr=0),chrome.bookmarks.getTree(L.ni)},ni:function(t){L.jr=2,L.Rr=[],L.Or=[],Y.qt(2),t.forEach(L.ei,L);var n=L.Dr;if(L.Dr=null,setTimeout(function(){return nt.ri(L.Rr)},50),L.Zr&&(setTimeout(L.Zr,0),L.Zr=null),n&&!n.o)return L.Fr()},ei:function(t){var n,e,i,u=t.title,o=t.id,l=L.Nr+"/"+(u||o);if(t.children)return L.Or.push(o),n=L.Nr,2<++L.Er&&(L.Nr=l),t.children.forEach(L.ei,L),--L.Er,void(L.Nr=n);i=(e=t.url).startsWith("javascript:"),L.Rr.push({ii:o,Nr:l,qr:u||o,t:i?"javascript:":e,Kr:F?Z.ui(e,u):1,u:i?"javascript:":e,Gr:i?e:null,Xr:i?r.Q(e):null})},Sr:0,oi:0,li:false,si:function(){var t=A.now()-L.oi;0===L.jr&&(t>=6e4||t<-5e3?(L.Sr=L.oi=0,L.li=false,L.Pr()):(L.Rr=[],L.Or=[],L.Sr=setTimeout(L.si,3e4),Y.qt(2)))},Yr:function(){L.oi=A.now(),L.jr<2||(L.Sr=setTimeout(L.si,6e4),L.jr=0)},ti:function(t,n){for(var e,r,i,u,o,l,s,f=L.Rr,a=f.length,c=n&&n.title,_=0;_<a&&f[_].ii!==t;_++);if(_<a)return r=(e=f[_]).u,i=n&&n.url,nt.fi&&(null==c?r!==e.t||!n:null!=i&&r!==i)&&nt.ai.has(r)&&X.Wr&&X.Qr(r)<0&&nt.ai.delete(r),void(null!=c?(e.Nr=e.Nr.slice(0,-e.qr.length)+(c||e.ii),e.qr=c||e.ii,i&&(e.u=i,e.t=nt.ci(i,e),nt._i()),F&&(e.Kr=Z.ui(e.u,e.qr))):(f.splice(_,1),n||L.Yr()));if(!(L.Or.indexOf(t)<0)){if(null!=c)return L.Yr();if(!L.li&&nt.fi){for(u=nt.ai,o=X.Qr,l=0,s=X.Wr?f:[];l<s.length;l++)u.has(r=s[l].u)&&o(r)<0&&u.delete(r);L.li=true}return L.Yr()}}},V={Zt:function(t,n){var e,r,i,u,o,l;if(!k.length&&1024&B||!(2&j))return W.Jr([],2);if(r=k.length>0,e=X.Hr){if(r)return W.Jr(V.gi(e),2);(X.mi>10||X.vi>0)&&X.di()}else if(i=r?function(n){if(!t.o)return W.Jr(V.gi(n),2)}:null,r&&(p||X.Si)?(X.Si>0&&clearTimeout(X.Si),X.Si=0,X.hi(i)):(X.Si||(X.Si=setTimeout(function(){X.Si=0,X.hi(i)},r?200:150)),r&&W.pi((l=(o=(u=W.Bi).length)>0)&&"search"===u[0].t?[u[0]]:[],h&&l,0,0,o,x,O)),r)return;h=false,0===n?W.Ui(V.yi,t):chrome.sessions?chrome.sessions.getRecentlyClosed(V.bi.bind(V,t)):V.Ti([],t,new Set,0,0)},gi:function(t){var n,e,i,u,o=1===k.length?k[0]:"",l=o&&("."===o[0]?/^\.[\da-zA-Z]+$/.test(o):(r.V(o,null,-2),r.B<=2)),s=l?"."===o[0]||r.B>0?G.Tr[0]:(G.wi||G.ki(),G.wi[0]):null,f=!(Y.Vr&&Y.Vr.Hr),a=Y.Lr?[]:null,m=[-1.1,-1.1],v=[],d=z.$r,S=l&&o.includes("%")&&!/[^\x21-\x7e]|%[^A-F\da-f]/.test(o),h=y+w,p=-1.1,B=0,U=0,b=0;for(I&&h++,U=h;--U;)m.push(-1.1,-1.1);for(h=2*h-2,f||(t=Y.Vr.Hr),n=t.length;B<n;B++)if(e=t[B],(l?s.test(S?e.u:e.t):d(e.t,e.qr))&&(J||e.Kr)&&(a&&a.push(e),b++,(i=l?c(e.zr)||1e-16*Math.max(0,e.zr):_(e.t,e.qr,e.zr))>p)){for(U=h-2;0<=U&&m[U]<i;U-=2)m[U+2]=m[U],m[U+3]=m[U+1];m[U+2]=i,m[U+3]=B,p=m[h]}for(a&&(Y.Lr.Hr=a),T+=b,b||(j^=2),5&j?B=0:(B=2*w,w=0);B<=h&&!((i=m[B])<=0);B+=2)(e=t[m[B+1]]).u!==I?((u=new P("history",e.u,S?e.u:e.t,e.qr,g,i)).visit=e.zr,v.push(u)):h--;return nt._i(),v},yi:function(t,n){var e,r,i,u,o,l;if(Y.Mi(n),!t.o){for(e=new Set,r=0,i=0,u=n;i<u.length;i++)(o=u[i]).incognito&&S||e.has(l=o.url||o.pendingUrl)||(e.add(l),r++);return V.Ti([],t,e,w,r)}},bi:function(t,n){var e,r,i;if(!t.o)return e=[],r=new Set,i=-w,n.some(function(t){var n,u,o,l=t.tab;return!!l&&((n=l.url).length>2e3&&(l.url=n=X.xi(n,l)),!(!J&&!Z.ui(n,l.title))&&!r.has(u=n+"\n"+l.title)&&(r.add(u),r.add(n),++i>0&&e.push({u:l.url,qr:l.title,Ri:(o=t.lastModified,o<3e11&&o>-4e10?1e3*o:o),Ci:l.sessionId}),e.length>=y))})?V.Oi(e):V.Ti(e,t,r,-i,0)},Ti:function(t,n,e,r,i){chrome.history.search({text:"",maxResults:w+y*(J?1:2)+i},function(i){if(!n.o){i=i.filter(function(t){var n=t.url;return n.length>2e3&&(t.url=n=X.xi(n,t)),!e.has(n)&&(J||0!==Z.ui(t.url,t.title||""))}),r<0?i.length=Math.min(i.length,y-t.length):r>0&&(i=i.slice(r,r+y));var u=i.map(function(t){return{u:t.url,qr:t.title,Ri:t.lastVisitTime,Ci:null}});r<0&&(u=t.concat(u)),V.Oi(u)}})},Oi:function(t){t.forEach(V.Di),w=0,nt._i(),W.Jr(t,2)},Di:function(t,n,e){var r=t.u,i=new P("history",r,nt.ci(r,r),t.qr||"",g,(99-n)/100),u=t.Ci;i.visit=t.Ri,u&&(i.s=u,i.label='<span class="undo">&#8630;</span>'),e[n]=i}},$={Zt:function(t,n){if(1!==k.length||!(16&j)||k[0].lastIndexOf("/",k[0].length-2)>=0)return W.Jr([],16);if(X.M);else{if(!X.Hr)return n>0?W.Jr([],16):X.hi(function(){if(!t.o)return $.Zt(t,0)});$.Pr(X.Hr)}return $.Fr()},Fr:function(){var e,i,u,o,l,s,f,a,c,m,v,d,S,p,B,U,b,M,x,R,C,O,D,N=r.M,j=z.Ni,F=k[0].replace("/","").toLowerCase(),A="",V=-1.1;for(z.Ni=3,l=N.keys(),s=void 0;!(s=l.next()).done;)(u=s.value).includes(F)&&(i=N.get(u),(J||i.Ii>0)&&(o=_(u,"",i.zr))>V&&(V=o,A=u));f=A.length===F.length,A&&!f&&(A.startsWith("www.")||A.startsWith(F)||(a=A.slice(A.indexOf(".")+1)).includes(F)&&(c=void 0,(c=N.get(a="www."+a))?(J||c.Ii>0)&&(A=a,i=c):(c=N.get(a="m."+a))&&(J||c.Ii>0)&&(J||c.Ii>0)&&(A=a,i=c)),(m=A.startsWith(F)?0:A.startsWith("www."+F)?4:-1)>=0&&(p=(d=(v=r.oe(A))[0]).length-1,(S=v[1])>1&&(!(m=A.length-m-F.length-d[p].length-1)||3===S&&m===d[p-1].length+1)&&(f=true))),A&&(T++,B=i.ne>0,U="",2===L.jr&&(b=new RegExp("^https?://"+A.replace(H,"\\$&")+"/?$"),(M=L.Rr.filter(function(t){return b.test(t.u)&&(J||t.Kr)})).length>0&&(x=M.filter(function(t){return"s"===t.u[4]}),E=(R=(M=(B=x.length>0)?x:M)[0].u).endsWith("/")?R.slice(0,-1):R,U=M[0].qr)),C=I=(B?"https://":"http://")+A+"/",w>0?w--:(h=f||h,e=new P("domain",C,F===k[0]?A:A+"/","",g,2),D=(O=X.Wr?X.Qr(C):-1)>0?X.Hr[O]:null,t(e),D&&(J||D.Kr)&&(e.visit=D.zr,U=U||D.qr),e.title=n(U,[]),--y)),z.Ni=j,W.Jr(e?[e]:[],16)},Pr:function(t){var n,e,i,u,o,l,s,f,a,c,_;for($.Pr=null,n=$.Ei,e=X.M=r.M,i=0,u=t;i<u.length;i++)l=(o=u[i]).zr,s=o.Kr,(f=n(o.u))&&(c=f.ji,(_=e.get(a=f.Fi))?(_.zr<l&&(_.zr=l),_.Ii+=s,c>=7&&(_.ne=8===c?1:0)):e.set(a,{zr:l,Ii:s,ne:8===c?1:0}))},Ei:function(t){var n,e,r=t.lastIndexOf(":",5),i=r>0?t.slice(0,r):"";if("http"===i)n=7;else if("https"===i)n=8;else{if("ftp"!==i)return null;n=6}return e=t.indexOf("/",n),{Fi:"__proto__"!==(t=t.slice(n,e<0?t.length:e))?t:".__proto__",ji:n}}},q={Zt:function(t,n){!(4&j)||n&&(!k.length||256&B)?W.Jr([],4):W.Ui(q.Fr,t)},Fr:function(t,n){var e,i,u,o,s,c,_,g,v,d,h,U,M,x,R,C,O,D,I,E,F,J,A,L,V,$,K,Q,H,G,X,Z,tt,et,rt,it,ut,ot,lt,st,ft,at;if(Y.Mi(n),!t.o){if(e=m.vt,i=k.length<=0,u=3&j,s=[],(o=!!(8&B)&&N&&i&&!p)&&!(128&B)&&n.length>w&&n.length>b){for(c=new Map,_=0,g=n;_<g.length;_++)c.set((v=g[_]).id,v);for(M=(U=(h=(d=c.get(e))?d.openerTabId:0)?c.get(h):null)?U.index:d?d.index-1:0,x=U?0:b/2|0;1<--x&&M>0&&n[M-1].openerTabId===h;M--);n=M>0?n.slice(M).concat(n.slice(0,M)):n}for(R=[],C=[],O=0,D=n;O<D.length;O++)v=D[O],!N&&S&&v.incognito||(I=v.url||v.pendingUrl,E=v.text||(v.text=nt.ci(I,v.incognito?"":I)),(i||z.$r(E,v.title))&&(F=v.windowId,!N&&C.lastIndexOf(F)<0&&C.push(F),R.push(v)));if(u&&1===R.length&&R[0].id===m.vt&&(R.length=0),T+=J=R.length,J||(j^=4),w>=J&&!u)return w=0,W.Jr(s,4);if(C.sort(q.Ji),A=i?o?q.Pi:q.Ai:a,L=o?r.L():null,V=C.length>1?m.ut:0,o)for($=0,K=R;$<K.length;$++)L[(v=K[$]).id]=(H=(Q=v.openerTabId)&&L[Q])?H<5?H+1:5:1;for(G=32&B?1===l.Xe.o?0:f<62?Date.now()-performance.now():performance.timeOrigin:0,X=0;X<R.length;)Z=(v=R[X++]).id,tt=o?L[Z]:1,I=v.url||v.pendingUrl,et=m.zt.get(Z),rt=new P("tab",I,v.text,v.title,A,o?X:Z),it=V&&v.windowId!==V?C.indexOf(v.windowId)+1+":":"",ut="",it+=X,e===Z?(o||(rt.r=i?1<<31:0),it="("+it+")"):et||(it="**"+it+"**"),!S&&v.incognito&&(ut+="*"),v.discarded&&(ut+="~"),rt.visit=et?et.t+G:0,rt.s=Z,rt.label="#"+it+(ut&&" "+ut),tt>1&&(rt.level=" level-"+tt),s.push(rt);if(s.sort(W.Li),lt=w+y-(ot=s.length),u||lt<0||!i)for(w>0&&!u?(s=s.slice(w,w+y),ot=y,w=0):ot>w+y&&(s.length=ot=w+y),x=u?0:ot;x<ot;x++)s[x].r*=8/(x/4+1);else if(w>0){for(ft=0,at=st=s.slice(0,lt);ft<at.length;ft++)at[ft].label+="[r]";for(ot=(s=s.slice(w).concat(st)).length,x=0;x<ot;x++)s[x].r=ot-x;w=0}nt._i(),W.Jr(s,4)}},Ji:function(t,n){return t-n},Ai:function(t,n){var e=m.zt.get(n);return e?e.i:4&B?2047+n:-n},Pi:function(t,n){return 1/n}},K={ue:0,Zt:r.b,Vi:function(t,n){var e,i,u,o,s,f,a,c,_,g;if(!(8&j))return W.Jr([],8);if(u=(i=k).length>0?i[0]:"",0===i.length);else{if(true!==n&&"\\"===u[0]&&"\\"!==u[1])return u.length>1?i[0]=u.slice(1):i.shift(),u=R.slice(1).trimLeft(),J=!F||J||Z.$i([u]),w?(w--,W.Jr([],8)):(e=K.qi(u),W.Jr([e],8));o=l.ce.searchEngineMap.get(u)}if(true===n){if(!o)return true}else{if(!o&&!u.startsWith("vimium://"))return 0===v&&i.length<=1&&(v=i.length?K.Ki():-1),W.Jr([],8);o&&C&&(i.push(C),w=0,R+=" "+C,C="",O&=-5),i.length>1||(v=-1)}if(i.length>1&&o?(i.shift(),R.length>200&&(i=R.split(" ")).shift()):o&&(i=[]),J=!F||J&&Z.$i([u]),o?(a=s=(c=r.ke(i,o.ye,o.b,[])).ye,f=c.xe):(a=s=i.join(" "),f=[]),"~"===u);else if(s.startsWith("vimium://")){if(_=r.K(s.slice(9),1,true),g=K.Wi.bind(K,i,s,a,o,f),_ instanceof Promise)return _.then(K.Qi.bind(K,t,g));if(_ instanceof Array)return K.Qi(t,g,_);_&&(s=a=_,f=[])}else s=r.V(s,null,-2);return e=K.Wi(i,s,a,o,f),W.Jr([e],8)},Qi:function(t,n,e){var i,u,o,l,s;if(!t.o){switch(e[1]){case 5:case 6:if(v=6===e[1]&&k.length>1?v:-1,!(u=e[0]))break;return C="",(k=((R="\\ "+u).length<201?R:r.S(R,0,200).trim()).split(" ")).length>1&&(k[1]=r.Se(k[1],k.length>2)),K.Vi(t);case 2:if(k=(o=e[0]).length>1||1===o.length&&o[0]?o:k,(l=K.ue++)>12)break;if(s=K.Vi(t,true),l<=0&&(K.ue=0),true!==s)return s;break;case 0:e[0]&&(i=K.zi(n(),e))}W.Jr(i||[n()],8)}},Wi:function(t,u,o,l,s){var f=new P("search",u,o,(l?l.Pe+": ":"")+t.join(" "),g,9);return t.length>0&&l?(f.t=K.Hi(o,s),f.title=n(f.title,[l.Pe.length+2,f.title.length]),f.textSplit=e(f.t,s)):(f.t=r.Q(i(o)),f.title=n(f.title,[]),f.textSplit=r.R(f.t)),p||(f.v=l&&l.b||K.a(u)),f.p=l?l.Pe:"",f},zi:function(t,e){var i=e[0],u=new P("math","vimium://copy "+i,i,i,g,9);return--u.r,u.title='<match style="text-decoration: none;">'+n(u.title,[])+"<match>",u.textSplit=r.R(e[2]),[t,u]},a:function(t){for(var n=X.Wr&&t.startsWith("http")?X.Qr(t):-1,e=n<0?~n-1:n,r=e<0?[]:X.Hr,i=t.indexOf(":")+3,u=0,o=0,l="",s="",f=0,a=0;u<=e&&(i="/"===t[i]?i+1:t.indexOf("/",i+1)+(o?0:1))>0;o=i){for(l=t.slice(o,i),a=e;u<=a;)if((s=r[f=u+a>>>1].u.slice(o))>l)a=f-1;else{if(s===l)return o?r[f].u:"";u=f+1}if(u<=e&&o&&"/"===(l=r[u].u)[i]&&l.length<=++i)return l}return""},Gi:0,dr:0,Ki:function(){var t=k[0],n=l.ce.searchKeywords;return null==n?(K.dr=K.dr||setTimeout(K.Xi,67),-2):t.length>=K.Gi?0:n.includes("\n"+t)?-2:0},Hi:function(t,n){var e,i,u,o=n.length;if(i=r.Q(n.length>0?t.slice(0,n[0]):t),(e=r.Te(i))&&(i=i.slice(e),e=0),n.length<=0)return i;for(u=n[0];n[e]=i.length,o>++e;)i+=r.Q(t.slice(u,n[e])),u=n[e];return u<t.length&&(i+=r.Q(t.slice(u))),i},qi:function(t){var e=r.V(t,null,-2),u=4===r.B,o=new P("search",e,r.Q(i(e)),"",g,9);return o.title=u?"~: "+n(t,[0,t.length]):n(t,[]),o.textSplit=r.R(o.t),p||(o.v=K.a(e)),o.p=u?"~":"",o.n=1,o},Xi:function(){var t,n,e,i=r.h(l.ce.searchEngineMap).sort(),u=0,o="",s=[];for(t=i.length;0<=--t;)o.startsWith(n=i[t])||(u=(e=n.length)>u?e:u,o=n,s.push(n));l.sn("searchKeywords","\n"+s.join("\n")),K.Gi=u,K.dr=0}},W={Zi:0,Yi:0,Bi:null,tu:null,pi:null,Zt:function(t){var n,e,r,i;if(W.tu&&(W.tu.o=true),n=W.tu={o:false},W.Yi=0,e=1,r=-9&(j&=t[0])?t.length:2,W.Bi=[],W.Zi=r-1,v=w&&-1,t[1]===K){if(i=K.Vi(n),r<3)return;if(i)return void i.then(W.nu.bind(null,t,n,e));e=2}W.nu(t,n,e)},nu:function(t,n,e){for(z.xr=Date.now()-18144e5,z.Ni=3*k.length||.01,k.indexOf("__proto__")>=0&&(k=k.join(" ").replace(/(^| )__proto__(?=$| )/g," __proto_").trimLeft().split(" ")),Y.yr(),k.sort(W.eu),G.ru();e<t.length;e++)t[e].Zt(n,e-1)},eu:function(t,n){return n.length-t.length||(t<n?-1:t===n?0:1)},Ui:function(t,n,e){var r,i=m.ft;null===S&&(i=1!==i?i:f>=52||l.C.qn||!!Y.zt.zt?m.ft=0:1),1!==i?(Y.zt.iu!==(r=((S=2!==i)?2:0)|(N?1:0))&&(Y.zt={zt:null,iu:r}),(e=e||Y.zt.zt)?t(n,e):chrome.tabs.query(N?{currentWindow:true}:{},t.bind(null,n))):chrome.windows.getCurrent({populate:N},function(e){m.ft=S?0:2,n.o||W.Ui(t,n,N?e.tabs:null)})},Jr:function(t,n){var e=W.Bi,r=t.length;if(r>0&&(W.Yi|=n,W.Bi=0===e.length?t:e.concat(t),8===n&&(h=!0,y-=r,T+=r)),0==--W.Zi)return e=null,W.uu()},uu:function(){var n,e,r,u,o,l,s,f,a,c,_,g,m=W.Bi;return W.Bi=null,m.sort(W.Li),w>0?(m=m.slice(w,w+b),w=0):m.length>b&&(m.length=b),G.ou=G.wi=null,k.length>0&&(e=i(n=k[0]),((r=n.length!==e.length)||n.endsWith("/")&&n.length>1&&!n.endsWith("//"))&&(k[0]=r?e:n.slice(0,-1),G.lu())),m.forEach(t),u=m.length>0,o=h&&u,l=T,s=":"===M,a=x,c=O,_=2!=(f=v<0?-2!==v||u?0:3:J?k.length<=0||D?0:u?2:s?3:1:0)||s?0:W.Yi,g=W.pi,W.su(),g(m,o,f,_,l,a,c)},su:function(){W.tu=W.pi=S=null,k=[],M=x=R=C=I=E="",G.Tr=null,z.Ni=3,z.xr=v=W.Yi=B=y=b=T=U=0,j=0,O=0,h=p=false,D=N=false,J=true},fu:function(){var t,n,e=R;if(w=0,C="",!(0===e.length||(t=(e=e.slice(-5)).lastIndexOf("+"))<0||0!==t&&32!==e.charCodeAt(t-1))){if(e=e.slice(t),t=R.length-e.length,(n=parseInt(e,10))>=0&&"+"+n===e&&n<=(t>0?100:200))w=n;else if("+"!==e)return;R=R.slice(0,t&&t-1),C=e,O|=4}},Li:function(t,n){return n.r-t.r}},Q={__proto__:null,bookm:[1,L],domain:[16,$],history:[2,V],omni:[63,K,$,V,L,q],search:[8,K],tab:[4,q]},z={$r:function(t,n){var e,r,i=G.Tr;for(e=0,r=k.length;e<r;e++)if(!(i[e].test(t)||i[e].test(n)))return false;return true},Ni:3,au:[0,0],cu:function(t,n){var e,r=0;return(e=n.split(G.Tr[t]).length)<1?z.au:(r=1,G.wi[t].test(n)&&(r+=1,G.ou[t].test(n)&&(r+=1)),[r,(e-1)*k[t].length])},Mr:function(t,n){var e,r,i,u=0,o=0,l=0,s=0,f=!!n;for(G.wi||G.ki(),e=0,r=k.length;e<r;e++)s+=(i=z.cu(e,t))[0],l+=i[1],f&&(o+=(i=z.cu(e,n))[0],u+=i[1]);return s=s/z.Ni*z._u(l,t.length),0===u?n?s/2:s:s<(o=o/z.Ni*z._u(u,n.length))?o:(s+o)/2},xr:0,_u:function(t,n){return t<n?t/n:n/t}},H=/[$()*+.?\[\\\]\^{|}]/g,G={Tr:null,wi:null,ou:null,ru:function(){var t,n,e,r=G.Tr=[];for(G.wi=G.ou=null,t=0,n=k;t<n.length;t++)e=n[t],r.push(new RegExp(e.replace(H,"\\$&"),e!==e.toUpperCase()&&e.toLowerCase()===e?"i":""))},ki:function(){var t,n,e,r,i,u=G.wi=[],o=G.ou=[];for(t=0,n=G.Tr;t<n.length;t++)r="\\b"+(e=n[t]).source,i=e.flags,u.push(new RegExp(r,i)),o.push(new RegExp(r+"\\b",i))},lu:function(){G.Tr&&(G.Tr[0]=new RegExp(k[0].replace(H,"\\$&"),G.Tr[0].flags))}},X={gu:0,mi:0,vi:0,Wr:false,Si:0,Hr:null,mu:null,M:null,hi:function(t){X.mu?t&&X.mu.push(t):(X.mu=t?[t]:[],X.gu=Date.now(),X.Si||chrome.history.search({text:"",maxResults:2e4,startTime:0},function(t){setTimeout(X.vu,0,t)}))},vu:function(t){var n,e,r,i,u,o,l;for(X.vu=null,n=0,e=t.length;n<e;n++)(i=(r=t[n]).url).length>2e3&&(i=X.xi(i,r)),t[n]={t:i,qr:r.title,zr:r.lastVisitTime,Kr:1,u:i};if(F)for(u=0,o=t;u<o.length;u++)0===Z.ui((l=o[u]).t,l.qr)&&(l.Kr=0);setTimeout(function(){setTimeout(function(){var t,n,e,r,i,u,o,l,s=X.Hr;for(t=s.length-1;0<t;)for(i=(r=(n=s[t]).t=nt.ci(e=n.u,n)).length>=e.length;0<=--t&&!((o=(u=s[t]).u).length>=e.length)&&e.startsWith(o);)u.u=e.slice(0,o.length),l=i?o:nt.ci(o,u),u.t=i||l.length<o.length?r.slice(0,l.length):l;X.M||setTimeout(function(){$.Pr&&$.Pr(X.Hr)},200)},100),X.Hr.sort(function(t,n){return t.u>n.u?1:-1}),X.Wr=true,chrome.history.onVisitRemoved.addListener(X.du),chrome.history.onVisited.addListener(X.Su)},100),X.Hr=t,X.hi=function(t){t&&t(X.Hr)},X.mu&&X.mu.length>0&&setTimeout(function(t){var n,e;for(n=0,e=t;n<e.length;n++)(0,e[n])(X.Hr)},1,X.mu),X.mu=null},Su:function(t){var n,e,r,i,u,o,l,s,f,a=t.url;if(a.length>2e3&&(a=X.xi(a,t)),n=t.lastVisitTime,e=t.title,r=++X.mi,i=X.M,(u=X.Qr(a))<0&&X.vi++,(r>59||r>10&&Date.now()-X.gu>3e5)&&X.di(),o=u>=0?X.Hr[u]:{t:"",qr:e,zr:n,Kr:F?Z.ui(a,e):1,u:a},i&&(s=$.Ei(a))&&((l=i.get(s.Fi))?(l.zr=n,u<0&&(l.Ii+=o.Kr),s.ji>=7&&(l.ne=8===s.ji?1:0)):i.set(s.Fi,{zr:n,Ii:o.Kr,ne:8===s.ji?1:0})),u>=0)return o.zr=n,void(e&&e!==o.qr&&(o.qr=e,Y.dr&&Y.qt(1),F&&(f=Z.ui(a,e),o.Kr!==f&&(o.Kr=f,l&&(l.Ii+=f||-1)))));o.t=nt.ci(a,o),X.Hr.splice(~u,0,o),Y.dr&&Y.qt(1)},du:function(t){var n,e,i,u,o,l,s,f,a,c,_,g,m;if(nt.hu.length=0,n=nt.ai,Y.qt(1),t.allHistory){for(X.Hr=[],X.M&&(X.M=r.M=new Map),e=new Map,i=0,u=L.Rr;i<u.length;i++)n.delete((o=u[i]).u);nt.ai=e}else for(l=X.Qr,s=X.Hr,f=X.M,c=0,_=t.urls;c<_.length;c++)(o=l(g=_[c]))>=0&&(f&&s[o].Kr&&(m=$.Ei(g))&&(a=f.get(m.Fi))&&--a.Ii<=0&&f.delete(m.Fi),s.splice(o,1),n.delete(g))},xi:function(t,n){var e=t.lastIndexOf(":",9),i=e>0&&"://"===t.substr(e,3),u=n.title;return t=t.slice(0,(i?t.indexOf("/",e+4):e)+320)+"\u2026",u&&u.length>160&&(n.title=r.S(u,0,160)),t},di:function(){var t=Date.now();if(X.vi<=0);else{if(t<X.gu+1e3&&t>=X.gu)return;setTimeout(chrome.history.search,50,{text:"",maxResults:Math.min(999,X.mi+10),startTime:t<X.gu?t-3e5:X.gu},X.pu)}return X.gu=t,X.vi=X.mi=0,nt._i()},pu:function(t){var n,e,r,i,u,o,l=X.Hr,s=X.Qr;if(!(l.length<=0))for(n=0,e=t;n<e.length;n++){if((i=(r=e[n]).url).length>2e3&&(r.url=i=X.xi(i,r)),(u=s(i))<0)X.vi--;else if(!(o=r.title)||o===l[u].qr)continue;X.mi--,X.Su(r)}},Qr:function(t){for(var n="",e=X.Hr,r=e.length-1,i=0,u=0;i<=r;)if((n=e[u=i+r>>>1].u)>t)r=u-1;else{if(n===t)return u;i=u+1}return~i}},Z={ui:function(t,n){var e,r,i;for(e=0,r=F;e<r.length;e++)if(n.includes(i=r[e])||t.includes(i))return 0;return 1},$i:function(t){var n,e,r,i,u,o;if(F)for(n=0,e=t;n<e.length;n++)for(r=e[n],i=0,u=F;i<u.length;i++)if(o=(o=u[i]).trim(),r.includes(o)||o.length>9&&r.length+2>=o.length&&o.includes(r))return true;return false},Bu:function(){var t,n,e,r,i,u,o,l,s;if(L.Rr)for(t=0,n=L.Rr;t<n.length;t++)(e=n[t]).Kr=F?Z.ui(e.t,e.Nr):1;if(X.Hr)for(r=X.M,i=0,u=X.Hr;i<u.length;i++)e=u[i],o=F?Z.ui(e.t,e.qr):1,e.Kr!==o&&(e.Kr=o,r&&(l=$.Ei(e.u))&&(s=r.get(l.Fi))&&(s.Ii+=o||-1))},Uu:function(t){var n,e,r,i=[];for(n=0,e=t.split("\n");n<e.length;n++)(r=e[n]).trim()&&"#"!==r[0]&&i.push(r);F=i.length>0?i:null,(X.Hr||L.Rr)&&setTimeout(Z.Bu,100)}},Y={Vr:null,Lr:null,zt:{zt:null,iu:0},yu:[],dr:0,bu:0,yr:function(){var t,n,e,r,i,u=k,o=null,s=0,f=u.join(" ");for(t=Y.yu,n=f?t.length:0;0<=--n;)if(t[n].Tu||!J){for(e=t[n].Ct,r=0,i=0;r<e.length&&i<u.length;i++)u[i].includes(e[r])&&r++;if(r>=e.length){o=t[n];break}}Y.Vr=o,o&&(l.en.t<200||!o.Hr||o.Hr.length>1e3)&&(s=A.now())-o.zr<Math.max(300,1.3*l.en.t)?(Y.Lr=o,o.Ct=u.slice(0)):!f||o&&f===o.Ct.join(" ")||!(f.length>4||/\w\S|[^\x00-\x80]/.test(f))?Y.Lr=null:(Y.Lr={Ct:u.slice(0),Tu:J,zr:s||A.now(),Hr:o&&o.Hr,Rr:o&&o.Rr},Y.yu.push(Y.Lr),Y.dr||(Y.dr=setInterval(Y.wu,6e3)))},wu:function(){for(var t=Y.yu,n=-1,e=A.now()-5983;++n<t.length&&t[n].zr<e;);++n<t.length?t.splice(0,n):(t.length=0,clearInterval(Y.dr),Y.dr=0)},qt:function(t){var n,e,r;for(n=0,e=Y.yu;n<e.length;n++)r=e[n],t<2?r.Hr=null:t<3?r.Rr=null:Y.zt.zt=null},Mi:function(t){Y.zt.zt!==t&&(Y.bu&&(clearTimeout(Y.bu),Y.bu=0),Y.zt.zt=t,t&&(Y.bu=setTimeout(Y.Mi,3e3,null)))}},tt=decodeURIComponent,nt={ci:function(t,n){if(t.length>=400||t.lastIndexOf("%")<0)return t;try{return tt(t)}catch(t){}return nt.ai.get(t)||(n&&nt.hu.push(n),t)},ri:function(t){for(var n,e,r=nt.ai,i=nt.hu,u=-1,o=t.length;;)try{for(;++u<o;)(n=t[u]).t=(e=n.u).length>=400||e.lastIndexOf("%")<0?e:tt(e);break}catch(t){n.t=r.get(e)||(i.push(n),e)}nt._i()},ai:new Map,hu:[],ku:-1,_i:function(){0!==nt.hu.length&&-1===nt.ku&&(nt.ku=0,setTimeout(nt.Mu,17,null))},Mu:function(t){for(var n,e,r,i,u,o,l;nt.ku<nt.hu.length;nt.ku++){if(!(n=nt.ai.get(i=(r="string"==typeof(e=nt.hu[nt.ku]))?e:e.u)))return t||(t=nt.xu())?(l=(o=(u=f>=66?i.split("#",3):[]).length)<2?i:o<3?u[0]+"%23"+u[1]:i.replace(/#/g,"%23"),t.open("GET",nt.Ru+l,true),t.send()):(nt.hu.length=0,void(nt.ku=-1));r||(e.t=n)}},Cu:function(){if(!(nt.ku<0)){var t=this.responseText,n=nt.hu[nt.ku++];"string"!=typeof n?nt.ai.set(n.u,n.t=t):nt.ai.set(n,t),nt.ku<nt.hu.length?nt.Mu(this):(nt.hu.length=0,nt.ku=-1)}},fi:true,Ru:"1",xu:function(){if(!nt.Ru)return null;var t=new XMLHttpRequest;return t.responseType="text",t.onload=nt.Cu,t},Ou:function(t){var n=!!t&&!(t=t.toLowerCase()).startsWith("utf"),e=n?"data:text/plain;charset="+t+",":"",i=nt.Ru;e!==i&&(nt.Ru=e,n?"1"!==i&&setTimeout(function(){return X.Hr&&nt.ri(X.Hr),nt.ri(L.Rr)},100):(nt.ai.clear(),nt.hu.length=0),nt.fi!==n&&(nt.hu=n?[]:{length:0,push:r.b},nt.fi=n,nt.ku=-1))}};d={Zt:function(t,n,e){var i,u,o,l;h=false,M=R=(t=t.trim())&&t.replace(r.O," "),x="",O=0,W.fu(),k=(t=R)?(t=t.length<201?t:r.S(t,0,200).trimRight()).split(" "):[],(U=0|n.c||128)&&(U-=t.replace(/[\u2e80-\u2eff\u2f00-\u2fdf\u3000-\u303f\u31c0-\u31ef\u3200-\u9fbf\uf900-\ufaff\ufe30-\ufe4f\uff00-\uffef]/g,"aa").length-t.length),U=Math.max(50,Math.min(U,320)),p=!!(1&(B=n.f)),b=y=Math.min(Math.max(3,0|n.r||10),25),T=0,W.pi=e,i="bomni"===n.o?(B|=64,Q.omni):Q[n.o],o=n.t,i===Q.tab&&(N=!!(2&B)),h=null!=i&&1===i.length,2===(u=k.length>=1?k[0]:"").length&&":"===u[0]&&(i="b"===(u=u[1])?Q.bookm:"h"===u?Q.history:"t"===u||"w"===u||"W"===u?(N="t"!==u,B|=0,Q.tab):"B"===u?(B|=64,Q.omni):"H"===u?(B|=256,Q.omni):"d"===u?Q.domain:"s"===u?Q.search:"o"===u?Q.omni:null)&&(h=1===i.length,x=k.shift(),O|=1,R=R.slice(3),0!==o&&(i=null)),k.length>0&&((u=k[0]).includes("\u3002")||u.includes("\uff1a"))&&(D=k.length<2,(l=r.Se(u,D))!==u?(k[0]=l,R=l+R.slice(u.length),D=D&&!/^[.\u3002](\w+[.\u3002]?)*$/.test(u)):D=D&&u.includes("\uff1a")&&!/\uff1a([^\/\d]|\d[^\0-\xff])/.test(u)),J=!F||Z.$i(k),j=0!==o?o:63,R&&(O|=2),W.Zt(i||Q.omni)},Gt:function(t,n,e){switch(n){case"tab":chrome.tabs.remove(+t,function(){var t=r.x();return t||Y.Mi(null),e(!t),t});break;case"history":var i=!X.Wr||X.Qr(t)>=0;chrome.history.deleteUrl({url:t}),i&&Y.qt(1),e(i)}},Ir:function(){Y.zt.zt&&(1&Y.zt.iu||!(2&Y.zt.iu)!=(2===m.ft))&&Y.Mi(null)},Du:Z.$i},l.mn.omniBlockList=Z.Uu,l.pn("omniBlockList"),l.mn.localeEncoding=nt.Ou,l.pn("localeEncoding"),r.Ae(80,function(){l.pn("searchEngines",null)})});var d={Zt:function(t,n,e){r.Ae(210,function(){return d.Zt(t,n,e)})},Gt:r.b,Ir:r.b};r.Ae(1e3,function(){var t,n,e,i,u,o,s,f,a,c,_,g,m,v=r.T({findModeRawQueryList:1,innerCSS:1,keyboard:1,newTabUrl_f:1,vomnibarPage_f:1}),d=null,S="",h=null,p=null,B=null,U=function(){return t||(t=chrome.storage&&chrome.storage.sync)},y=function(t){b(t,"sync")},b=function(t,n){var e,i,u,o;if("sync"===n){if(e=function(t){var n,e,i,u;if(h){for(n in r.T(t),h)!(i=(e=n.split(":")[0])===n)&&e in h||w(e,null!=(u=i?h[n]:null)?u.newValue:t[e],t);h=null}},r.T(t),i=l.zn&&l.zn())return h&&r.r(t,h),h=t,void i.then(function(){return b({},n)});for(u in h&&(r.r(t,h),h=null),t){if(o=t[u],8===(u.includes(":")?8:w(u,null!=o?o.newValue:null)))return h=t,void U().get(e);delete t[u]}}},T=function(){var t,n=[];for(t=0;t<arguments.length;t++)n[t]=arguments[t];console.log.apply(console,[(new Date).toLocaleString()].concat.call([].slice.call(arguments,0)))},w=function(t,n,e){var r,i,u,o,f,a;if(t in l.rn&&!(t in l.in)&&c(t)){if(r=l.rn[t],i=n&&"object"==typeof n&&n.$_serialize||""){if("split"===i&&!e)return 8;if(8===(n=s(t,n,e)))return}null!=n?(u=B?r:l.on(t),(a="object"!=typeof r)?(f=n,o=u):(f=JSON.stringify(n),o=JSON.stringify(u)),f!==o&&(f===(u=a?r:JSON.stringify(r))&&(n=r),B||T("sync.this: update",t,"string"==typeof n?(n.length>32?n.slice(0,30)+"...":n).replace(/\n/g,"\\n"):n),k(t,n))):null!=localStorage.getItem(t)&&(B||T("sync.this: reset",t),k(t,r))}},k=function(t,n){var e="keyMappings"===t||"exclusionRules"===t?"KeyMappings":"";if(!e)return M(t,n);r.me(e).then(M.bind(null,t,n)),r.Fe()},M=function(t,n){S=t,l.sn(t,n),S="",t in l.ln&&l.hn({N:6,d:[l.ln[t]]})},x=function(t,n){c(t)&&t!==S&&(d||(setTimeout(a,800),d=r.L()),d[t]=n)};if(e=function(t,n){var e,i,u;U()?(i=chrome.storage.local,u=function(){var n=r.x();if(n)return T("storage.local: Failed to update",t,":",n.message||n),n},null==n?i.remove(t,u):i.set(((e={})[t]=n,e),u)):l.cn=r.b},i=function(t){return t.replace(/[<`\u2028\u2029]/g,function(t){return"<"===t?"`l":"`"===t?"`d":"\u2028"===t?"`r":"`n"})},u=function(t){return t.replace(/"|\\[\\"]/g,function(t){return'"'===t?"`q":'\\"'===t?"`Q":"`S"})},o=function(t){var n={Q:'\\"',S:"\\\\",d:"`",l:"<",n:"\u2029",q:'"',r:"\u2028"};return t.replace(/`[QSdlnqr]/g,function(t){return n[t[1]]})},s=function(t,n,e){var r,i,u,s,f="";switch(n.$_serialize){case"split":for(r=n.k,i=n.s,u=0;u<i;u++){if(!(s=e[t+":"+u])||!s.startsWith(r))return 8;f+=s.slice(r.length)}break;case"single":return JSON.parse(o(JSON.stringify(n.d)));default:return T("Error: can not support the data format in synced settings data:",t,":",n.$_serialize),null}return"string"==typeof l.rn[t]?f=o(f):(f=o(JSON.stringify(f)),JSON.parse(f.slice(1,-1)))},f=function(t,n,e){var r,o,s,f,a,c,_,g,m,v,d,S;if(n&&!("string"!=typeof n?"object"!=typeof n:n.length<8192/6-40)&&(o="",!((r=JSON.stringify(n)).length<8192/6-40))){if(4*(r=i(r)).length<8093)return r;if((o=e.encode(r)).length<8093)return r;for(s=0,f=Date.now().toString(36)+":",a={},r="string"==typeof l.rn[t]?r.slice(1,-1):u(r),p||(p=new TextDecoder),c=0,_=(o=e.encode(r)).length;c<_;){for(g=Math.min(c+8134,_),m=void 0,v=0;g<_&&128==(192&o[g]);g--);if((v=(r=(m=p.decode(o.subarray(c,g))).slice(-6)).lastIndexOf("\\"))>r.length-2)m+="b",v=1;else if(v>0&&"u"===r[v+1])for(d=v=r.length-v;d++<6;m+="b");else v=0;if(m=JSON.parse('"'+m+'"'),v&&((S=m.endsWith("b"))||(g-=v),m=m.slice(0,v>1&&S?v-6:-1)),a[t+":"+s++]=f+m,c=g,s>=13)break}return a[t]={$_serialize:"split",k:f,s:s},a}},a=function(){var t,n,e,i,u,o,s,a,c=d,_=[],g=[],m=[],v=r.L(),S={};if(d=null,c&&l.cn===x){for(n in t=new TextEncoder,c)for(i=c[e=n],o="string"==typeof(u=l.rn[e])||"object"==typeof u&&"vimSync"!==e?0:13,null!=i?(s=f(e,i,t))&&"object"==typeof s?(v[e]=s,o=s[e].s):(S[e]=s?{$_serialize:"single",d:JSON.parse(s)}:i,g.push(e)):(m.push(e),_.push(e));o<13;o++)m.push(e+":"+o);for(e in p=t=null,_.length>0&&T("sync.cloud: reset",_.join(", ")),m.length>0&&U().remove(m),g.length>0&&(T("sync.cloud: update",g.join(", ")),U().set(S)),a=function(t){U().set(v[t],function(){var n=r.x();return n?T("Failed to update",t,":",n.message||n):T("sync.cloud: update (serialized) "+t),n})},v)a(e)}},c=function(t){return!(t in v)},_=function(t){l.De.Ge=null,r.Ae(t,function(){chrome.storage.local.get(function(t){var n,i,u,o,s,f,a,_,g;if(!l.on("vimSync")&&localStorage.length){for(T("storage.local: backup all settings from localStorage"),r.T(t),n=0,i=localStorage.length;n<i;n++)(u=localStorage.key(n))in l.rn&&(c(u)||"keyboard"===u)&&(o=l.rn[u],s=t[u],a=f=l.on(u),_=s,"object"==typeof o&&(_=JSON.stringify(s),a=JSON.stringify(f)),a!==_&&e(u,f),delete t[u]);(g=Object.keys(t)).length>0&&chrome.storage.local.remove(g)}})})},g=function(t,i,u){var o,s,f,a,_,g,m,v,d,h,p,y,k,M;if(2&i&&chrome.storage.local.get(function(t){var n,e,o,s,f=r.x();if(f)return l.zn=null,(i-=2)||u(),f;for(o in r.T(t),e=void 0!==(n=t.vimSync)||Object.keys(t).length>0,delete t.vimSync,e&&T("storage.local: restore settings to localStorage"),t)o in l.rn&&(S=o,s=null==(s=t[o])?l.rn[o]:s,l.sn(o,s));S="",null!=n&&l.sn("vimSync",n),r.Ae(100,function(){l.hn({N:6,d:l.Xe})}),(i-=2)||u()}),2!==i){if(r.T(t),!(o=t.vimSync||l.on("vimSync")))return n=o,l.cn=e,void(--i||u());for(f in t.vimSync||(T("sync.cloud: enable vimSync"),t.vimSync=o,U().set({vimSync:o})),s=[],t)f in l.xn&&s.push(f);for(a=[],_={},g=0,m=s;g<m.length;g++)for(f=m[g],v=l.xn[f],d=-1,h=void 0;d<13&&(h=d<0?f:f+":"+d)in t;d++)_[p=d<0?v:v+":"+d]=t[p]=t[h],delete t[h],a.push(h);for(s.length>0&&(chrome.storage.onChanged.removeListener(b),l.cn=r.b,U().remove(a),U().set(_,r.x),s.length=0),d=0,y=localStorage.length;d<y;d++)!((f=localStorage.key(d))in t)&&f in l.rn&&c(f)&&s.push(f);for(k=0,M=s;k<M.length;k++)w(f=M[k],null);for(f in t)f.includes(":")||w(f,t[f],t);l.pn("vimSync"),r.Ae(4,function(){--i||u()}),B&&T("sync.cloud: download settings to localStorage")}},l.mn.vimSync=function(t){var r,i,u;if(n=t,U()){if(i=(r=U().onChanged)||chrome.storage.onChanged,u=r?y:b,!t)return i.removeListener(u),void(l.cn!==e&&(l.cn=e,_(600)));l.cn!==x&&(i.addListener(u),l.cn=x,chrome.storage.local.clear())}},l.zn=function(){if(B);else{if(localStorage.length)return null;r.Fe(),B=r.me("KeyMappings").then(function(){return new Promise(function(t){n?U().get(function(n){var e=r.x();return e?(l.zn=null,t()):g(n,1,t),e}):g({},2,t)})}).then(function(){B=null})}return B},false===(n=l.on("vimSync"))||!n&&!l.De.He)return m=l.De.Ge,l.De.Ge=m?null:_,m&&_(6e3),void(l.cn=e);r.Fe(),U()?U().get(function(t){var n=r.x();if(n)return T("Error: failed to get storage:",n,"\n\tSo disable syncing temporarily."),l.mn.vimSync=l.cn=r.b,l.zn=null,n;B=Promise.resolve(),B=new Promise(function(n){return g(t,3,n)}).then(function(){B=null})}):l.zn=null}),r.Ae(150,function(){var t,e,i,u,o=chrome.browserAction;o&&(i=l.mn.showActionIcon,u=function(n){var i=l.Sn[n];fetch(i).then(function(t){return t.arrayBuffer()}).then(function(i){var u,o,l,s=new Uint8ClampedArray(i),f=i.byteLength/5,c=0|Math.sqrt(f/4),_=c+c,g=r.L();for(g[c]=new ImageData(s.subarray(0,f),c,c),g[_]=new ImageData(s.subarray(f),_,_),t[n]=g,u=e.get(n),e.delete(n),o=0,l=u.length;o<l;o++)a.ct(u[o],n,true)})},l.De.Ye=function(n){var r,i,u;if(null==n)return!!t;if(n){if(!t)for(i in t=[null,null,null],e=new Map,r=a.gn())0!==(u=r[+i][0].s).s&&a.ct(u.t,u.s)}else t&&setTimeout(function(){l.on("showActionIcon")||(t=null,e=null)},200)},a.ct=function(n,i,l){var s,f,a;(s=t[i])?(f=o.setIcon,a={tabId:n,imageData:s},l?f(a,r.x):f(a)):e.has(i)?e.get(i).push(n):(setTimeout(u,0,i),e.set(i,[n]))},l.mn.showActionIcon=function(t){i(t),l.De.Ye(t);var e=n("name");t||(e+="\n\n"+n("noActiveState")),o.setTitle({title:e})},l.pn("showActionIcon"))}),r.Ae(600,function(){function t(){h&&(h.Nu=null),B=y=h=v=null,b&&clearTimeout(b),p&&clearTimeout(p),T=k=M=b=p=0,S="",r.y()}function e(){var n=Date.now()-T;if(n>5e3||n<-5e3)return t();b=setTimeout(e,3e4)}function i(){var t,n;if(p=0,(t=h)&&!t.Iu)return h=null,t.Nu?((n=Date.now())<T&&(T=n-1e3),o(t.oo,t.Nu)):void 0}function u(t,e,i,u,o){var s,f,a,_,d,p,U,b,T,x,R,C,O,D,N,I,E,j;if(t.Nu){for(h=null,f=(s=e.length>0)?e[0]:null,_={},k=u,M=o,s&&(g||null!=e[0].s)&&(B=new Map),y=[],d=new Set,p=(" "+l.en.s+" ").includes(" type-letter "),U=0,b=i?0:1,T=e.length;U<T;U++)R=(x=e[U]).title,C=x.u,O=x.e,D="",N=null!=x.s,I=g&&!(i&&0===U)&&("tab"===O?x.s!==m.vt:"history"===O&&!N),d.has(C)?C=":"+(U+b)+" "+C:d.add(C),I&&(_.iu=O,D=" ~"+(U+b)+"~"),E={content:C,description:D=(R||p?(R?R+" <dim>":"<dim>")+(p?"["+x.e[0].toUpperCase()+"] ":"")+(R?"-</dim> <url>":"</dim><url>"):"<url>")+x.textSplit+"</url>"+(D&&"<dim>"+D+"</dim>")},I&&(E.deletable=true),N&&(_.Ci=x.s),(I||N)&&(B.set(C,_),_={}),y.push(E);if(v=t.oo,i)if("search"===f.e){if(a=((j=f.p)&&"<dim>"+(r.R(j)+c)+"</dim>")+"<url>"+f.textSplit+"</url>",w=2,f=e[1])switch(f.e){case"math":y[1].description=f.textSplit+" = <url><match>"+f.t+"</match></url>"}}else w=3,a=y[0].description;else 1!==w&&(a="<dim>"+n("OpenC")+"</dim><url>%s</url>",w=1);i&&(S=e[0].u,y.shift()),a&&chrome.omnibox.setDefaultSuggestion({description:a}),t.Nu(y),r.y()}else h===t&&(h=null)}function o(t,n){var o,s,f,a;t=t.trim().replace(r.O," "),h&&(h.Nu=(o=t===h.oo)?n:null,o)||(t!==v?1===k&&t.startsWith(v)?n([]):(h={Nu:n,oo:t,Iu:false},p||(s=Date.now(),(f=l.en.t+T-s)>30&&f<3e3?p=setTimeout(i,f):(h.Iu=true,b||(b=setTimeout(e,3e4)),T=s,B=y=null,S="",a=k<2||!t.startsWith(v)?0:3===k?t.includes(" ")?0:8:M,d.Zt(t,{o:"omni",t:a,r:x,c:U,f:1},u.bind(null,h))))):y&&n(y))}function s(t,n,e){return t?":"===t[0]&&/^:([1-9]|1[0-2]) /.test(t)&&(t=t.slice(" "===t[2]?3:4)):t=r.V(""),"file://"===t.slice(0,7).toLowerCase()&&(t=r.ze(t)),null!=e?a.ot[5]({s:e}):a.ot[6]({u:t,r:"currentTab"===n?0:"newForegroundTab"===n?-1:-2},null)}var c,_,g,v,S,h,p,B,U,y,b,T,w,k,M,x,R=chrome.omnibox;R&&(c=n("colon")+n("NS"),g=!!(_=R.onDeleteSuggestion)&&"function"==typeof _.addListener,v=null,S="",h=null,p=0,B=null,U=128,y=null,b=0,w=0,k=0,M=0,x=f<60?6:12,R.onInputStarted.addListener(function(){if(chrome.windows.getCurrent(function(t){var n=t&&t.width;U=n?Math.floor((n-160/devicePixelRatio)/7.72):128}),b)return t()}),R.onInputChanged.addListener(o),R.onInputEntered.addListener(function n(e,u){var o,l=h;if(l&&l.Nu){if(l.Nu=n.bind(null,e,u),l.Iu)return;return p&&clearTimeout(p),i()}return e=e.trim().replace(r.O," "),null===v&&e?d.Zt(e,{o:"omni",t:0,r:3,c:U,f:1},function(t,n){return n?s(t[0].u,u,t[0].s):s(e,u)}):(S&&e===v&&(e=S),o=B&&B.get(e)&&B.get(e).Ci,t(),s(e,u,o))}),g&&_.addListener(function(t){var n=parseInt(t.slice(t.lastIndexOf("~",t.length-2)+1))-1,e=y&&y[n].content,r=e&&B&&B.get(e)||null,i=r&&r.iu;if(i)return":"===e[0]&&(e=e.slice(e.indexOf(" ")+1)),a.Gt({t:i,u:"tab"===i?r.Ci:e});console.log("Error: want to delete a suggestion but no related info found (may spend too long before deleting).")}))}),chrome.runtime.onInstalled.addListener(l.De.Be=function(t){var e=t.reason;if("install"===e)e="";else{if("update"!==e)return;e=t.previousVersion}l.De.Be&&(chrome.runtime.onInstalled.removeListener(l.De.Be),l.De.Be=null,r.Ae(500,function(){var i,u;chrome.tabs.query({status:"complete"},function(t){var n,e,i,u,o=chrome.tabs,s=r.x,f=/^(file|ftps?|https?):/,a=location.origin.length,c=l.C.Un;for(n=t.length,e=c.length-1;0<=--n;)if(f.test(t[n].url))for(i=t[n].id,u=0;u<e;++u)o.executeScript(i,{file:c[u].slice(a),allFrames:true},s)}),console.log("%cVimium C%c has been %cinstalled%c with %o at %c%s%c.","color:red","color:auto","color:#0c85e9","color:auto",t,"color:#0c85e9",new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toJSON().slice(0,-5).replace("T"," "),"color:auto"),l.C.qn&&console.log("Sorry, but some commands of Vimium C require the permission to run in incognito mode."),e?parseFloat(l.C.vn)<=parseFloat(e)||((i=l.De).Ge?i.Ge(6e3):i.Ge=true,l.on("notifyUpdate")&&(e="vimium_c-upgrade-notification",u={type:"basic",iconUrl:location.origin+"/icons/icon128.png",title:"Vimium C "+n("Upgrade"),message:n("upgradeMsg",[l.C.Cn])+n("upgradeMsg2")+"\n\n"+n("clickForMore")},f<67&&(u.isClickable=true),f>=70&&(u.silent=true),chrome.notifications&&chrome.notifications.create(e,u,function(t){var n;if(n=r.x())return n;e=t||e,chrome.notifications.onClicked.addListener(function(t){t===e&&(chrome.notifications.clear(e),a.ot[19]({u:r.V("vimium://release")}))})}))):(l.zn&&l.zn()||Promise.resolve()).then(function(){a.ot[19]({u:l.C.Nn+"#commands"})})}))}),r.Fe=function(t){function n(){if(Math.abs(performance.now()-e)<1e5)i=setTimeout(n,3e5);else{i=0;var t=l.mn;KeyMappings&&(t.keyMappings=null,KeyMappings=null)}}var e=0,i=0,u=0;return r.Fe=function(t){t&&(u=u+t>0?u+t:0),u>0||!KeyMappings?i&&(clearTimeout(i),i=0):(e=performance.now(),i=i||setTimeout(n,3e5))},r.Fe(t)},r.Ae(1200,function(){l.De.Be&&chrome.runtime.onInstalled.removeListener(l.De.Be),l.De.Be=null,document.documentElement.innerHTML="",r.y()});